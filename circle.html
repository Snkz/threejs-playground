<html>
    <head>
        <title> Threejs bs </title>
        <style> canvas { width: 100%; height: 100% } 
				body { background-image:url('textures/white-lines.gif'); background-color: #FFFFFF;
					   margin: 20px 10px 10px; font: 11px/19px Verdana, Arial, Helvetica, sans-serif; 
					   color: #000000; -webkit-font-smoothing: antialiased; -webkit-text-size-adjust: 
					   100%;}
					   
				#side { width: 168px; margin: 0px auto; padding: 0px 10px 0px 10px; display: inline; float: left; } 
				#data { margin: 0px 10px; display: inline; float: left;} 
                #icon { width: 128px; height: 128px; padding-left: 30px;} 
                #title {} 
				#leftbar { float: right; padding: 0px 10px 0px 10px;} 
				#section80 { float: right;  display: block; margin: -5px 0px -10px 0px;} 
				#section { text-align: right; margin-bottom: -10px ; padding: 00px;} 
                #content {  } 
				#blurb { text-align: right; padding-left: 32px;}
				#rainbow { colour: #000000 }
				#location { margin: 0px 0px; }
				ul li{ text-align: right; list-style-type: none; margin: 0; padding: 0; }

				a { text-decoration: none;}
				a:hover { text-decoration: none; outline:rgba(0,0,0,0.025) solid 2px;

        </style>
    </head>
    <body>
	  
		<div id="side">
			<div id="icon">
			<!-- ICON JS GEN-->
			</div>
			<div id="leftbar">
				<p id = "blurb"> 
					Here's a blurb about me, ill fill it out with details
					like about how im moving to nyc or how im the greatest
					that ever was, or how i have a cool shader thing that 
					will hopefully be mouse controlled and not entirely taxing
					for the users computer!
					
					It could also very well be entirely pointless but oh well I LOVE IT!
					
					Name is DIZZLE MOFO.
				</p>
				<div id="section80">
					<h4 id="section" class="rainbow"> on the ground </h4>
					<ul>
						<li>
							<p id= "location"> uoft: bahen center </p>
						</li>
						<li>
							<p id="location"> columbia: SEL lab </p>
						</li>

					</ul>
				</div>
				<div id="section80">
					<h4 id="section" class="rainbow"> on the web </h4>
					<ul>
						<li>
							<a href = "https://github.com/snkz"> github.com/snkz </a>
						</li>
						<li>
							<a href = "https://twitter.com/snkz"> twitter.com/snkz </a>
						</li>
						<li>
							<a href="mailto:abdi.dahir@outlook"> abdi.dahir@outlook.com </a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div id="data">
			<div id="title">
				<h3 class="rainbow"> Say hi my friends, this should be the title! </h3>
			</div>
			<div id="content">
				<h4 class="rainbow"> If i can get my css right, this will be to the right! </h4>
				<p> this  p tag is just a bunch of jabrooni </p>
			</div>
		</div>
		
		<!-- j whattt? -->
		<script src="js/three.min.js"></script>
        <script id="vertexShader" type="x-shader/x-vertex">
            precision highp float;

            varying vec2 vUv;
            attribute float displacement;
            varying vec3 vNormal;
            uniform float amp;

            void main() {
                vNormal = normal;
                vUv = uv;
                vec3 newPos = position; // + normal * vec3(displacement * amp);
                gl_Position = projectionMatrix * modelViewMatrix * vec4(newPos, 1.0 );
            }

        </script>
        <script id="fragmentShader" type="x-shader/x-fragment">
            uniform float time;
            uniform vec2 resolution;
            varying vec2 vUv;
            varying vec3 vNormal;

            void main( void ) {

            vec2 position = vUv;
            float color = 0.0;
            color += sin( position.x * cos( time / 15.0 ) * 80.0 ) + cos( position.y * cos( time / 15.0 ) * 10.0 );
            color += sin( position.y * sin( time / 10.0 ) * 40.0 ) + cos( position.x * sin( time / 25.0 ) * 40.0 );
            color += sin( position.x * sin( time / 5.0 ) * 10.0 ) + sin( position.y * sin( time / 35.0 ) * 80.0 );
            color *= sin( time / 10.0 ) * 0.5;
            gl_FragColor = vec4( vec3( color, color * 0.5, sin( color + time / 3.0 ) * 0.75 ), 1.0 );
            //gl_FragColor = vec4( position.x, 0.0, 0.0, 1.0 );

            }
        </script>
		<script id="julia-fs" type="x-shader/x-fragment">
            precision highp float;

            uniform float time;
            uniform vec2 resolution;
            varying vec2 vUv;
            varying vec3 vNormal;
            uniform float amp;


            void main(void) {
                vec2 position = vUv;
				float x = (position.x - 0.5) * 3.0;
                float y = (position.y - 0.5) * 3.0;
                //float x = position.x * 3.5 - 2.5;
                //float y = position.y * 2.0 - 1.0;
                //float cx = position.x;
                //float cy = position.y;

                float hue;
                float saturation;
                float value;
                float hueRound;
                int hueIndex;
                float f;
                float p;
                float q;
                float t;
				
				//-0.835 -0.2321
				//-0.8 0.156
				// -0.4 0.6
				// 0.285 0.01
				// 0.29357170269 -0.4885853614

				//float cx = -0.835;
                //float cy =  -0.2321;
				//float cx = -0.8;
                //float cy =  0.156;
                //float cx = -0.40;
                //float cy =  0.6;
				//float cx = 0.285;
                //float cy =  0.01;
				//float cx = 0.74543;
				//float cy = 0.11301;
				float cx = 0.29357170269;
                float cy = -0.4885853614;
				
                float tempX = 0.0;
                int i = 0;
                int runaway = 0;
				float z = 0.0;
				float zf = 0.0;
                for (int i=0; i < 256; i++) {
                    tempX = x * x - y * y + float(cx);
                    y = 2.0 * x * y + float(cy);
                    x = tempX;
					z = x*x + y*y;
                    if (runaway == 0 && z > 4.0) {
                        runaway = i;
						zf = sqrt(z);
                        //break;
                    }
                }
				float br = 0.0;
                if (runaway != 0) {
                    //NIC COLOURING
                    //float z = sqrt(xf*xf + yf*yf);
                    br = log2(1.75 + float(runaway) - log2(log2(zf))) / log2(256.0);
                    
                } else {
                    //gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
					br = log2(1.75 + float(256) - log2(log2(z))) / log2(256.0);
					br = 1.0;

				}
			 gl_FragColor = vec4(br - amp, br, 1.0, 1.0);
            }
        </script>
        <script id="mandshader-fs" type="x-shader/x-fragment">
            precision highp float;

            uniform float time;
            uniform vec2 resolution;
            varying vec2 vUv;
            varying vec3 vNormal;
            uniform float amp;


            void main(void) {
                vec2 position = vUv;
                float cx = position.x * 3.5 - 2.5;
                float cy = position.y * 2.0 - 1.0;

                float hue;
                float saturation;
                float value;
                float hueRound;
                int hueIndex;
                float f;
                float p;
                float q;
                float t;
	
                float x = 0.0;
                float y = 0.0;
                float tempX = 0.0;
                int i = 0;
                int runaway = 0;
				float z = 0.0;
				float zf = 0.0;
                for (int i=0; i < 128; i++) {
                    tempX = x * x - y * y + float(cx);
                    y = 2.0 * x * y + float(cy);
                    x = tempX;
					z = x*x + y*y;
                    if (runaway == 0 && z > 4.0) {
                        runaway = i;
						zf = sqrt(z);
                        //break;
                    }
                }
				float br = 0.0;
                if (runaway != 0) {
                    //NIC COLOURING
                    //float z = sqrt(xf*xf + yf*yf);
                    br = log2(1.75 + float(runaway) - log2(log2(zf))) / log2(128.0);
					gl_FragColor = vec4(br - amp, amp -br, 1.0, 1.0);

                    
                } else {
                    //gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
					gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);

				}
            }
        </script>
		<script id="juliaSINE-fs" type="x-shader/x-fragment">
            precision highp float;

            uniform float time;
            uniform vec2 resolution;
            varying vec2 vUv;
            varying vec3 vNormal;
            uniform float amp;

			float cosh(float val)
			{
				float tmp = exp(val);
				float cosH = (tmp + 1.0 / tmp) / 2.0;
				return cosH;
			}

			float sinh(float val)
			{
				float tmp = exp(val);
				float sinH = (tmp - 1.0 / tmp) / 2.0;
				return sinH;
			}
            void main(void) {
                vec2 position = vUv;
				float x = (position.x - 0.5) * 9.42;
                float y = (position.y - 0.5) * 9.42;
               
                float hue;
                float saturation;
                float value;
                float hueRound;
                int hueIndex;
                float f;
                float p;
                float q;
                float t;
				
				int itter = 256;
				float cx = 1.0;
                float cy =  1.9;
				
                float tempX = 0.0;
				float ctempX = 0.0;
                int i = 0;
                int runaway = 0;
				float z = 0.0;
				float zf = 0.0;
				
				
                for (int i=0; i < 256; i++) {
				
                    tempX = sin(x) * cosh(y);
                    y = cos(x) * sinh(y);
                    x = tempX;
					
					ctempX = x * float(cx) - y * float(cy);
					y = x * float(cy) + y * float(cx);
					x = ctempX;
					z = x*x + y*y;
                    if (runaway == 0 && z > 2500.0) {
                        runaway = i;
						zf = sqrt(z);
                        //break;
                    }
                }
				float br = 0.0;
                if (runaway != 0) {
                    //NIC COLOURING
                    //float z = sqrt(xf*xf + yf*yf);
                    br = log2(1.75 + float(runaway) - log2(log2(zf))) / log2(float(itter));
                    
                } else {
                    //gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
					br = log2(1.75 + float(itter) - log2(log2(z))) / log2(float(itter));
					br = 1.0;

				}
			 gl_FragColor = vec4(br - amp, amp*amp - br, amp*amp, 1.0);
            }
        </script>
        <script id="main">
            var mahname = "icon";
            var div = document.getElementById(mahname); 
            // our bs goes here
            var scene = new THREE.Scene();
            var clock = new THREE.Clock();
            var targetRotationX = 0;
            var targetRotationOnMouseDownX = 0;
            var targetRotationY = 0;
            var targetRotationOnMouseDownY = 0;
            var mouseX = 0;
            var mouseX = 0;
            var mouseXOnMouseDown = 0;
            var mouseY = 0;
            var mouseYOnMouseDown = 0;
			
			var hoverState = 0;


            // group
            group = new THREE.Object3D();
            group.position.x = 0.0;
            group.position.y = 0.0;
            group.position.z = 0.0;
			group.rotation.x = Math.PI;


            // camera
            var camera = new THREE.PerspectiveCamera( 30, div.offsetWidth / div.offsetHeight, 1, 10000 );
            camera.position.y = 0;
            camera.position.z = 10;
            scene.add( camera );

            var light = new THREE.DirectionalLight( 0x404040 ); 
            light.position.set( 50, 200, 100 );
            light.position.multiplyScalar( 1.3 );
            light.castShadow = true;
            light.shadowMapWidth = 2048;
            light.shadowMapHeight = 2048;

            var d = 300;
            light.shadowCameraLeft = -d;
            light.shadowCameraRight = d;
            light.shadowCameraTop = d;
            light.shadowCameraBottom = -d;
            light.shadowCameraFar = 1000;
            light.shadowDarkness = 0.5;
            scene.add( light );

            light = new THREE.DirectionalLight( 0x3dff0c, 0.35 );
            light.position.set( 0, -1, 0 );
            scene.add( light );


            var renderer = new THREE.WebGLRenderer( { alpha: true });
            renderer.setSize(div.offsetWidth, div.offsetHeight);
            renderer.setClearColor( 0x000000, 0 );
            div.appendChild(renderer.domElement);

            // geos
            var plane = new THREE.Mesh(
                        new THREE.PlaneGeometry(4, 4, 20, 20), 
                        new THREE.MeshBasicMaterial({ color: 0x7f7f7f, wireframe: true })
            );
            plane.rotation.x = Math.PI;
			plane.position.set(0,0,-2);

            var geometry = new THREE.SphereGeometry(2,25,25);
            //var material = new THREE.MeshBasicMaterial( {color: 0x0000ff} );

            // post proc
            var uniforms = {
                time: { type: "f", value: 1.0 },
                amp: { type: "f", value: 0.0 },
                resolution: { type: "v2", value: new THREE.Vector2() }
            };

            var attributes = {
                displacement: { type: "f", value: [] }
            };

            var material = new THREE.ShaderMaterial({
                uniforms: uniforms,
                attributes: attributes,
                vertexShader: document.getElementById( 'vertexShader' ).textContent,
                fragmentShader: document.getElementById( 'juliaSINE-fs' ).textContent
            });

            var sphere = new THREE.Mesh(geometry, material);
            //var sphere = new THREE.Mesh(geometry, new THREE.MeshNormalMaterial());
            var verts = sphere.geometry.vertices;
            var values = attributes.displacement.value;

            for (var v = 0; v < verts.length; v++) {
                values.push(Math.random() * 0.50);
            }

            group.add(sphere);
            //group.add(plane);
			//scene.add(plane);
            scene.add(group);

            function onWindowResize( event ) {
                uniforms.resolution.value.x = div.offsetWidth;
                uniforms.resolution.value.y = div.offsetHeight;
                camera.aspect = div.offsetWidth / div.offsetHeight;
                camera.updateProjectionMatrix();
                renderer.setSize( div.offsetWidth, div.offsetHeight );
            }

			function domUpdater(amp, cls, bkg) {
				var  fontElems = document.querySelectorAll(cls);
				var red = Math.floor((1.0 - amp)*255)
				var green = Math.floor((amp*amp - 1.0)*255);
				var blue = Math.floor((amp*amp)*255)
				var alpha = 0.1;
				for (var i = 0; i < fontElems.length; i++) {
					fontElems[i].style.color = "rgb(" + red + "," + green + "," + blue + ")";
					if (bkg === true) {
						fontElems[i].style.background = "rgba(" + red + "," 
																+ green + "," 
																+ blue + "," 
																+ alpha + ")";
						hoverState = 1;
					}
				}
			}
			
		function domCleaner(cls) {
				if (hoverState == 0) {
					return;
				}
				var  fontElems = document.querySelectorAll(cls);
				for (var i = 0; i < fontElems.length; i++) {
					fontElems[i].style.background = "";
					fontElems[i].style.color = "";
				}
				
				hoverState = 0;
			}
			
            function render() {
                requestAnimationFrame(render);

                var delta = clock.getDelta();
                uniforms.time.value += delta;     
                uniforms.amp.value = Math.sin(uniforms.time.value) * 1;     

                sphere.rotation.x += 0.01;
                sphere.rotation.y += 0.02;
                sphere.rotation.z += 0.03;

                group.rotation.y += ( targetRotationX - group.rotation.y ) * 0.05;
                group.rotation.x += ( targetRotationY - group.rotation.x ) * 0.05;


				// random dom changing
				domCleaner("a");
				domUpdater(uniforms.amp.value, ".rainbow", false);
				domUpdater(uniforms.amp.value, "a:hover", true);
                
				renderer.render(scene, camera);
            }


	        // click events
	        function onDocumentMouseDown( event ) {

        	    //event.preventDefault();
        
        	    document.addEventListener( 'mousemove', onDocumentMouseMove, false );
        	    document.addEventListener( 'mouseup', onDocumentMouseUp, false );
        	    document.addEventListener( 'mouseout', onDocumentMouseOut, false );
        
        	    mouseXOnMouseDown = event.clientX - window.innerWidth/2;
	            mouseYOnMouseDown = event.clientY - window.innerHeight/2;

        	    targetRotationOnMouseDownX = targetRotationX;
        	    targetRotationOnMouseDownY = targetRotationY;
            };

	        function onDocumentMouseMove( event ) {

	        	mouseX = event.clientX - window.innerWidth/2;
	        	mouseY = event.clientY - window.innerHeight/2;

	        	targetRotationX = targetRotationOnMouseDownX + ( mouseX - mouseXOnMouseDown ) * 0.20;
	        	targetRotationY = targetRotationOnMouseDownY + ( mouseY - mouseYOnMouseDown ) * 0.20;
	        };

            // add remove event listeners on the fly
            function onDocumentMouseUp( event ) {

	        	document.removeEventListener( 'mousemove', onDocumentMouseMove, false );
	        	document.removeEventListener( 'mouseup', onDocumentMouseUp, false );
	        	document.removeEventListener( 'mouseout', onDocumentMouseOut, false );
	        };

	        function onDocumentMouseOut( event ) {

	        	document.removeEventListener( 'mousemove', onDocumentMouseMove, false );
	        	document.removeEventListener( 'mouseup', onDocumentMouseUp, false );
	        	document.removeEventListener( 'mouseout', onDocumentMouseOut, false );
	        };


            onWindowResize();
            document.addEventListener( 'mousedown', onDocumentMouseDown, false );
            window.addEventListener( 'resize', onWindowResize, false );
            render();
        </script>

    </body>
</html>

